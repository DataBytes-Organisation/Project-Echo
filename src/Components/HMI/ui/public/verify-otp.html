<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="./css/auth-form.css" type="text/css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />
    <title>Echo | Verify OTP</title>
</head>

<body>
    <div class="screen" id="screen">
        <div class="screen-image"></div>
        <div class="screen-overlay"></div>
        <div class="screen-content">
            <img src="./images/logo-splashscreen.png" style="width: 101px; height: 81px">
            <div class="screen-user">
                <span class="name animate" data-value="PROJECT ECHO">PROJECT ECHO</span>
            </div>
        </div>

        <div id="otp-form-container" class="user-auth-form">
            <form class="modal-content animate" action="/api/2fa/verify" method="POST">
                <div class="imgcontainer">
                    <h2>Two-Factor Authentication</h2>
                </div>

                <div class="container">
                    <p style="text-align: center; margin-bottom: 20px;">Please enter the OTP sent to your phone</p>
                    
                    <label for="otp"><b>OTP Code</b></label>
                    <input type="text" placeholder="Enter 6-digit OTP" name="otp" maxlength="6" required>
                    <input type="hidden" name="user_id" id="userId">

                    <button type="submit" class="loginbtn">Verify OTP</button>

                    <div class="container" style="background-color:#f1f1f1">
                        <button type="button" onclick="window.location.href='/login'" class="cancelbtn">Cancel</button>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Get user_id from URL parameters and set it in the hidden input
        const urlParams = new URLSearchParams(window.location.search);
        const userId = urlParams.get('user_id');
        
        if (!userId) {
            window.location.href = '/login';
        }
        
        document.getElementById('userId').value = userId;
    </script>
</body>
</html>
